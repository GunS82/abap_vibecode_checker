# ABAP Objects Parser

**Анализатор зависимостей ABAP-кода** — инструмент для извлечения и анализа зависимостей из ABAP-программ.

## Описание

ABAP Objects Parser — это Python-инструмент для статического анализа ABAP-кода, который извлекает:

* **Классы и интерфейсы** — зависимости от объектно-ориентированных компонентов
* **Функции** — вызовы функциональных модулей и BAPI
* **Таблицы** — обращения к таблицам базы данных
* **DDIC-объекты** — структуры данных, домены и другие объекты словаря данных

## Возможности

* **Быстрый анализ** — обработка файлов любого размера
* **Пакетная обработка** — анализ целых папок с ABAP-программами
* **Проверка существования** — сверка найденных объектов с базовыми списками
* **Детальная статистика** — подробные отчёты по категориям зависимостей
* **JSON-выход** — структурированные результаты для дальнейшей обработки
* **Умная фильтрация** — исключение внутренних таблиц и системных объектов

## Установка

### Требования

* Python 3.8+
* Операционная система: Windows, Linux, macOS

### Быстрая установка

```bash
# Клонирование репозитория
git clone https://github.com/your-username/abap-parser.git
cd abap-parser

# Установка базовой версии (только стандартные библиотеки)
pip install -e .

# Установка с зависимостями для анализа
pip install -e .[analysis]

# Установка всех зависимостей (включая dev-инструменты)
pip install -e .[all]
```

### Альтернативная установка

```bash
# Установка только необходимых зависимостей для анализа папок
pip install tabulate pandas
```

## Использование

### Анализ отдельного файла

```bash
# Базовый анализ
python abap_objects_parser.py "path/to/your/program.abap"

# Пример вывода
{
  "classes_and_interfaces": ["CL_SALV_TABLE", "CX_ROOT"],
  "functions": ["BAPI_TRANSACTION_COMMIT", "REUSE_ALV_GRID_DISPLAY"],
  "database_tables": ["VBFA", "MARA", "KNA1"],
  "other_ddic_dependencies": ["SLIS_FIELDCAT_ALV", "BAPIRET2"]
}
```

### Анализ папки с программами

```bash
# Анализ всех ABAP-файлов в папке
python folder_analyzer.py "path/to/abap/programs"

# Результат: детальный отчёт + JSON-файл с результатами
```

### Пример вывода анализатора папки

```
============================================================
Файл: example_program.abap
============================================================
Всего объектов: 25  
Размер файла: 15420 байт  
Время парсинга: 0.045 сек

--- Классы и интерфейсы (2) ---
✅ В базе:
   • CL_SALV_TABLE  
   • CX_ROOT

--- Функции (8) ---
✅ В базе:
   • BAPI_TRANSACTION_COMMIT  
   • REUSE_ALV_GRID_DISPLAY  
❌ Не в базе:
   • CUSTOM_FUNCTION_MODULE

--- Таблицы (5) ---
✅ В базе:
   • VBFA  
   • MARA  
```

## Структура проекта

```
abap-parser/
├── abap_objects_parser.py     # Основной парсер
├── folder_analyzer.py         # Анализатор папок
├── pyproject.toml             # Конфигурация проекта
├── requirements.txt           # Зависимости (legacy)
├── README.md                  # Документация
├── Base/                      # Базовые списки объектов
│   ├── classes.txt            # Список классов/интерфейсов
│   ├── functions.txt          # Список функций
│   └── tables.txt             # Список таблиц
├── LLM ABAP Programs/         # Тестовые программы (LLM)
└── Real ABAP Programs/        # Реальные ABAP-программы
```

## Конфигурация

### Базовые списки объектов

Парсер использует файлы в папке `Base/` для проверки существования найденных объектов:

* **classes.txt** — список известных классов и интерфейсов
* **functions.txt** — список функциональных модулей
* **tables.txt** — список таблиц базы данных

### Поддерживаемые расширения файлов

* `.abap` — стандартные ABAP-программы
* `.txt` — текстовые файлы с ABAP-кодом

## Разработка

### Установка dev-зависимостей

```bash
pip install -e .[dev]
```

### Запуск тестов

```bash
pytest
```

### Форматирование кода

```bash
black .
ruff check .
```

### Проверка типов

```bash
mypy .
```

## Примеры результатов

### Статистика анализа папки

```json
{
  "input_folder": "Real ABAP Programs",
  "total_files": 6,
  "successful_files": 6,
  "summary_statistics": {
    "total_objects_by_category": {
      "classes_and_interfaces": 7,
      "functions": 51,
      "database_tables": 52,
      "other_ddic_dependencies": 120
    },
    "unique_objects_by_category": {
      "classes_and_interfaces": 7,
      "functions": 49,
      "database_tables": 49,
      "other_ddic_dependencies": 117
    }
  }
}
```

## Вклад в проект

1. Форкните репозиторий
2. Создайте ветку для новой функции (`git checkout -b feature/amazing-feature`)
3. Зафиксируйте изменения (`git commit -m 'Add amazing feature'`)
4. Отправьте в ветку (`git push origin feature/amazing-feature`)
5. Откройте Pull Request

## Лицензия

Данный проект распространяется под лицензией MIT. См. файл `LICENSE` для подробностей.

## Сообщения об ошибках

Если вы нашли ошибку или у вас есть предложения по улучшению, пожалуйста, создайте [issue](https://github.com/your-username/abap-parser/issues).

## Производительность

* **Скорость**: \~400KB-файл обрабатывается за \~0.9 секунды
* **Память**: минимальное потребление благодаря потоковой обработке
* **Масштабируемость**: поддержка пакетной обработки сотен файлов

## Версии

* **v1.0.0** — первый стабильный релиз

  * Основной функционал парсинга
  * Анализ папок
  * JSON-отчёты
  * Базовая проверка существования объектов


